package me.dsmd.vulnerability_testing.groovy

import org.apache.commons.io.FileUtils

import java.nio.charset.StandardCharsets
import java.util.zip.ZipEntry
import java.util.zip.ZipFile

class VulnerableZipSlipClass {
    def List<String> zipSlipNoncompliant(ZipFile zipFile) throws IOException {
        Enumeration<? extends ZipEntry> entries = zipFile.entries()
        List<String> filesContent = new ArrayList<>()

        while (entries.hasMoreElements()) {
            ZipEntry entry = entries.nextElement()
            File file = new File(entry.getName())
            String content = FileUtils.readFileToString(file, StandardCharsets.UTF_8)
            filesContent.add(content)
        }

        return filesContent;
    }
}
